version: 1.0
description: A workflow to perform service state alert remediation
input:
  - data
vars:
  - sources: []
tasks:
  parsealert:
      action: uem_stackstorm.parse_service_state_alert
      input:
        alertBody: <% ctx().data %>
      next:
      - when: <% succeeded() %>
        publish: 
          - sources: <% result().result %>
        do: startservice

  startservice:
      with: <% ctx().sources %>
      action: core.echo 
      input:
        message: "<% item().service_name %> service for <% ctx().host %> host in <% item().environment %> envt of <% item().datacenter %> DC will be re-started."